

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data Management in Python Using Standard Tooling &mdash; Python Empirical Research Workflows 0.1.0 documentation</title>
  

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script >var copybuttonSkipText = '>>> ';</script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Additional Research Tools" href="additional_research_tools.html" />
    <link rel="prev" title="Examples and Workflows" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Python Empirical Research Workflows
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples and Workflows</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data Management in Python Using Standard Tooling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#give-me-a-dataframe">Give me a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>!</a></li>
<li class="toctree-l3"><a class="reference internal" href="#working-with-data-in-pandas">Working with Data in Pandas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#selecting-data">Selecting Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#aggregating">Aggregating</a></li>
<li class="toctree-l4"><a class="reference internal" href="#merging">Merging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-series">Time series</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#regressions">Regressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-and-output">Input and Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#some-clean-up">Some Clean Up</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="additional_research_tools.html">Additional Research Tools</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python Empirical Research Workflows</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Examples and Workflows</a> &raquo;</li>
        
      <li>Data Management in Python Using Standard Tooling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/auto_examples/data_management_in_python.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-data-management-in-python-py"><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p>
</div>
<div class="sphx-glr-example-title section" id="data-management-in-python-using-standard-tooling">
<span id="sphx-glr-auto-examples-data-management-in-python-py"></span><h1>Data Management in Python Using Standard Tooling<a class="headerlink" href="#data-management-in-python-using-standard-tooling" title="Permalink to this headline">¶</a></h1>
<p>Prior to beginning the tutorial, please install the following packages
via <code class="docutils literal notranslate"><span class="pre">pip</span></code>: - pandas - matplotlib - statsmodels - seaborn - openpyxl -
xlrd</p>
<p><strong>Note</strong>: if you’re using Anaconda, some of these will be installed
already.</p>
<p><strong>Note</strong>: if you’re running the example in Binder, no installation is
necessary</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> is a large library which includes a data structure called a
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> which is originally based on R’s <code class="docutils literal notranslate"><span class="pre">data.frame</span></code>. In
Python, it is built on top of the array datatype in the similarly
popular <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library. Each column in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is a
<code class="docutils literal notranslate"><span class="pre">pandas</span> <span class="pre">Series</span></code>.</p>
<p>I use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> for some specific functions or when I need higher
performance than <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, but <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is much more convenient to
use.</p>
<p>Here is what we’re going to cover:</p>
<ul class="simple">
<li><p><a class="reference external" href="#Selecting-Data">**Selecting Data**</a></p></li>
<li><p><a class="reference external" href="#Aggregating">**Aggregating**</a></p></li>
<li><p><a class="reference external" href="#Merging">**Merging**</a></p></li>
<li><p><a class="reference external" href="#Time-series">**Time series**</a></p></li>
<li><p><a class="reference external" href="#Plotting">**Plotting**</a></p></li>
<li><p><a class="reference external" href="#Regressions">**Regressions**</a></p></li>
<li><p><a class="reference external" href="#Input-and-Output">**Input and Output**</a></p></li>
</ul>
</div>
<div class="section" id="give-me-a-dataframe">
<h2>Give me a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>!<a class="headerlink" href="#give-me-a-dataframe" title="Permalink to this headline">¶</a></h2>
<p>A <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be created in many ways, including: - From a <code class="docutils literal notranslate"><span class="pre">csv</span></code>
or Excel file - From a <code class="docutils literal notranslate"><span class="pre">SAS7BDAT</span></code> (SAS data) or <code class="docutils literal notranslate"><span class="pre">dta</span></code> (Stata data)
file - From other Python data structures (list of tuples, dictionaries,
<code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays)</p>
<p>Here I will create an example <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> from a list of tuples. At
the end I will show loading and writing to files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1">#this is the convention for importing pandas, then you can use pd. for functions</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;Walmart&#39;</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;1/2/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">02</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Walmart&#39;</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;1/3/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">03</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Walmart&#39;</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;1/4/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">04</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Trader Joes&#39;</span><span class="p">,</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;1/2/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">06</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Trader Joes&#39;</span><span class="p">,</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;1/3/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">07</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Trader Joes&#39;</span><span class="p">,</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;1/4/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">08</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Publix&#39;</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;1/2/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Publix&#39;</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;1/3/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">11</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Publix&#39;</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;1/4/2000&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">12</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Return&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> combined with Jupyter gives you a nice representation of your
data by simply typing the name of the variable storing your
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /></div>
<div class="section" id="working-with-data-in-pandas">
<h2>Working with Data in Pandas<a class="headerlink" href="#working-with-data-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>One of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s greatest strengths is how flexibly they can
be split, combined, and aggregated.</p>
<div class="section" id="selecting-data">
<h3>Selecting Data<a class="headerlink" href="#selecting-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FL&#39;</span><span class="p">]</span> <span class="c1"># read: dataframe where the dataframe column &#39;state&#39; is &#39;FL&#39;</span>

<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># give me the second through the third rows</span>

<span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="c1"># all rows for the third column (looks different because it&#39;s a Series)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">]</span> <span class="c1"># company column (Series)</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">best_grocery_stores</span></a> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Trader Joes&#39;</span><span class="p">,</span> <span class="s1">&#39;Publix&#39;</span><span class="p">]</span>
<span class="c1"># only rows where company is in the best grocery stores and has a high return,</span>
<span class="c1"># but also give me only the company and return columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">best_grocery_stores</span></a><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.07</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Return&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>0.12</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /></div>
<div class="section" id="aggregating">
<h3>Aggregating<a class="headerlink" href="#aggregating" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s have a <code class="docutils literal notranslate"><span class="pre">.groupby</span></code> which works similarly to group by
in a SQL (proc SQL) command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Company&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7f0d894ac850&gt;
</pre></div>
</div>
<p>To make it useful, we must aggregate the data somehow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#also .median, .std, .count</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Return</th>
    </tr>
    <tr>
      <th>State</th>
      <th>Date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">FL</th>
      <th>1/2/2000</th>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1/3/2000</th>
      <td>0.07</td>
    </tr>
    <tr>
      <th>1/4/2000</th>
      <td>0.08</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">GA</th>
      <th>1/2/2000</th>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1/3/2000</th>
      <td>0.07</td>
    </tr>
    <tr>
      <th>1/4/2000</th>
      <td>0.08</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Note that there the index becomes the groupby columns. If we want keep
the columns in the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, pass <code class="docutils literal notranslate"><span class="pre">as_index=False</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1">#also .median, .std, .count</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>5</th>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Note that the shape of the data when using plain groupby is whatever the
shape of the unique values of the groupby columns. If instead we want to
add a column to our <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> representing the aggregated values,
use <code class="docutils literal notranslate"><span class="pre">.transform</span></code> on top of <code class="docutils literal notranslate"><span class="pre">groupby</span></code>.</p>
<p>This example also shows how to assign a new column to a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;State Return Average&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Columns can be combined with basic math operations</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;State Return Average&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Functions can be applied to columns or the entire <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># convention for importing numpy.</span>

<span class="k">def</span> <span class="nf">sort_ratios</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>

    <span class="c1"># If the value is missing or is not a number, return as is</span>
    <span class="c1"># Without this, the function will error out as soon as it hits either of those</span>
    <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="c1"># Otherwise, sort into categories based on the value</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Even&#39;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;Low&#39;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;High&#39;</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ratio Size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Ratio&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">sort_ratios</span></a><span class="p">)</span> <span class="c1"># apply function to ratio column, save result as ratio size column</span>
<span class="n">df</span>

<span class="n">df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">sort_ratios</span></a><span class="p">)</span> <span class="c1"># apply function to all values in df, but only display and don&#39;t save back to df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Ratio Size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>Low</td>
      <td>Low</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>Low</td>
      <td>Low</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>Low</td>
      <td>Low</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>Even</td>
      <td>Even</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>Even</td>
      <td>Even</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>Even</td>
      <td>Even</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>High</td>
      <td>High</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>High</td>
      <td>High</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>Low</td>
      <td>Low</td>
      <td>High</td>
      <td>High</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /></div>
<div class="section" id="merging">
<h3>Merging<a class="headerlink" href="#merging" title="Permalink to this headline">¶</a></h3>
<p>See here for more details.</p>
<p>Let’s create a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing information on employment rates
in the various states and merge it to this dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">employment_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">employment_df</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">employment_df</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Ratio Size</th>
      <th>Unemployment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>Low</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>Low</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>Low</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>High</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>High</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>High</td>
      <td>0.06</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Appending is similarly simple. Here I will append a slightly modified
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to itself:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">copy_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">copy_df</span><span class="p">[</span><span class="s1">&#39;Extra Column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">copy_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Ratio Size&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># inplace=True means it gets dropped in the existing DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">copy_df</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Ratio Size</th>
      <th>Unemployment</th>
      <th>Extra Column</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>Low</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>Low</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>Low</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>High</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>High</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>High</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>NaN</td>
      <td>0.08</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>NaN</td>
      <td>0.06</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>We can append to the side as well! (concatenate)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">copy_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">temp_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Ratio Size</th>
      <th>Unemployment</th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Unemployment</th>
      <th>Extra Column</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>Low</td>
      <td>0.06</td>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>0.06</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>Low</td>
      <td>0.06</td>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>0.06</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>Low</td>
      <td>0.06</td>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>0.06</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>0.08</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>0.08</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>0.08</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>High</td>
      <td>0.06</td>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>0.06</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>High</td>
      <td>0.06</td>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>0.06</td>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>High</td>
      <td>0.06</td>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>0.06</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Be careful, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> allows you to have multiple columns with the same
name (generally a bad idea):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">temp_df</span><span class="p">[</span><span class="s1">&#39;Unemployment&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unemployment</th>
      <th>Unemployment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.08</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.08</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.08</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.06</td>
      <td>0.06</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /></div>
<div class="section" id="time-series">
<h3>Time series<a class="headerlink" href="#time-series" title="Permalink to this headline">¶</a></h3>
<p>See here for more details.</p>
<div class="section" id="lagging">
<h4>Lagging<a class="headerlink" href="#lagging" title="Permalink to this headline">¶</a></h4>
<p>Lags are easy with <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. The number in shift below represents the
number of rows to lag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Lag Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Ratio Size</th>
      <th>Unemployment</th>
      <th>Lag Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>High</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>High</td>
      <td>0.06</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>High</td>
      <td>0.06</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>But really we want the lagged value to come from the same firm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Lag Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Company&#39;</span><span class="p">)[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State Return Average</th>
      <th>Ratio</th>
      <th>Ratio Size</th>
      <th>Unemployment</th>
      <th>Lag Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>High</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>High</td>
      <td>0.06</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Publix</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>High</td>
      <td>0.06</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/2/2000</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/3/2000</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>1/4/2000</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/2/2000</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>Low</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/3/2000</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>1/4/2000</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Things get slightly more complicated if you want to take into account
missing dates within a firm. Then you must fill the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with
missing data for those excluded dates, then run the above function, then
drop those missing rows. A bit too much for this tutorial, but I have
code available for this upon request.</p>
</div>
<div class="section" id="resampling">
<h4>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> has a lot of convenient methods for changing the frequency of
the data.</p>
<p>Here I will create a df containing intraday returns for the three
companies</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/itertools.html#itertools.product" title="View documentation for itertools.product"><span class="n">product</span></a>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">firms</span></a> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># list of companies in df</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">dates</span></a> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># list of dates in df</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="View documentation for builtins.int"><span class="n">num_periods_per_day</span></a> <span class="o">=</span> <span class="mi">13</span> <span class="c1">#30 minute intervals</span>
<a href="https://docs.python.org/3/library/itertools.html#itertools.product" title="View documentation for itertools.product"><span class="n">combos</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/itertools.html#itertools.product" title="View documentation for itertools.product"><span class="n">product</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">firms</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">dates</span></a><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="View documentation for builtins.int"><span class="n">num_periods_per_day</span></a><span class="p">)])</span> <span class="c1"># all combinations of company, date, and period number</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">data_tuples</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span>
        <span class="n">combo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="c1"># company</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">combo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="View documentation for datetime.timedelta"><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span></a><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mf">9.5</span><span class="p">,</span> <span class="n">minutes</span><span class="o">=</span><span class="mi">30</span> <span class="o">*</span> <span class="n">combo</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="c1">#datetime</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span> <span class="c1"># price</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <a href="https://docs.python.org/3/library/itertools.html#itertools.product" title="View documentation for itertools.product"><span class="n">combos</span></a>
<span class="p">]</span>
<span class="n">intraday_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">data_tuples</span></a><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Datetime&#39;</span><span class="p">,</span> <span class="s1">&#39;Price&#39;</span><span class="p">])</span>
<span class="n">intraday_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span> <span class="c1"># now the df is quite long, so we can use df.head() and df.tail() to see beginning and end of df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>Datetime</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Publix</td>
      <td>2000-01-02 10:00:00</td>
      <td>17.883223</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Publix</td>
      <td>2000-01-02 10:30:00</td>
      <td>43.879632</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Publix</td>
      <td>2000-01-02 11:00:00</td>
      <td>25.017481</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Publix</td>
      <td>2000-01-02 11:30:00</td>
      <td>87.846884</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Publix</td>
      <td>2000-01-02 12:00:00</td>
      <td>45.210976</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>First must set the date variable as the index to do resampling</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intraday_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Datetime&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can resample to aggregate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intraday_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Company&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Price</th>
    </tr>
    <tr>
      <th>Company</th>
      <th>Datetime</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Publix</th>
      <th>2000-01-02</th>
      <td>43.116576</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>56.454147</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>42.228872</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Trader Joes</th>
      <th>2000-01-02</th>
      <td>49.378817</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>40.615718</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>50.801066</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Walmart</th>
      <th>2000-01-02</th>
      <td>44.689049</td>
    </tr>
    <tr>
      <th>2000-01-03</th>
      <td>46.861734</td>
    </tr>
    <tr>
      <th>2000-01-04</th>
      <td>64.478415</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Or we can increase the frequency of the data, using <code class="docutils literal notranslate"><span class="pre">bfill</span></code> to
backward fill or <code class="docutils literal notranslate"><span class="pre">ffill</span></code> to forward fill. Here I specify to backward
fill but only go back one period at most.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">intraday_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Company&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;10min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bfill</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Company</th>
      <th>Price</th>
    </tr>
    <tr>
      <th>Company</th>
      <th>Datetime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="10" valign="top">Publix</th>
      <th>2000-01-02 10:00:00</th>
      <td>Publix</td>
      <td>17.883223</td>
    </tr>
    <tr>
      <th>2000-01-02 10:10:00</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02 10:20:00</th>
      <td>Publix</td>
      <td>43.879632</td>
    </tr>
    <tr>
      <th>2000-01-02 10:30:00</th>
      <td>Publix</td>
      <td>43.879632</td>
    </tr>
    <tr>
      <th>2000-01-02 10:40:00</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02 10:50:00</th>
      <td>Publix</td>
      <td>25.017481</td>
    </tr>
    <tr>
      <th>2000-01-02 11:00:00</th>
      <td>Publix</td>
      <td>25.017481</td>
    </tr>
    <tr>
      <th>2000-01-02 11:10:00</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2000-01-02 11:20:00</th>
      <td>Publix</td>
      <td>87.846884</td>
    </tr>
    <tr>
      <th>2000-01-02 11:30:00</th>
      <td>Publix</td>
      <td>87.846884</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /></div>
</div>
<div class="section" id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h3>
<p>Oh yeah, we’ve got graphs too. <code class="docutils literal notranslate"><span class="pre">pandas</span></code>’ plotting functionality is
built on top of the popular <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library, which is a graphing
library based on <code class="docutils literal notranslate"><span class="pre">MATLAB</span></code>’s graphing functionality.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># we&#39;ve got to run this magic once per session if we want graphics to show up in the notebook</span>
<span class="c1"># %matplotlib inline</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> tries to guess what you want to plot. By default it will put
each numeric column as a y variable and the index as the x variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_data_management_in_python_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_data_management_in_python_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f0d7434f650&gt;
</pre></div>
</div>
<p>But we can tell it specifically what we want to do. Maybe we want one
plot for each company showing only how the company return moves relative
to the state average return over time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span> <span class="c1"># convert date from string type to datetime type</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Company&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">,</span> <span class="s1">&#39;State Return Average&#39;</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../_images/sphx_glr_data_management_in_python_002.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_data_management_in_python_002.png" />
</li>
<li><img alt="../_images/sphx_glr_data_management_in_python_003.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_data_management_in_python_003.png" />
</li>
<li><img alt="../_images/sphx_glr_data_management_in_python_004.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_data_management_in_python_004.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Company
Publix         AxesSubplot(0.125,0.11;0.775x0.77)
Trader Joes    AxesSubplot(0.125,0.11;0.775x0.77)
Walmart        AxesSubplot(0.125,0.11;0.775x0.77)
dtype: object
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> exposes most of the plots in <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>. Supported types
include: - ‘line’ : line plot (default) - ‘bar’ : vertical bar plot -
‘barh’ : horizontal bar plot - ‘hist’ : histogram - ‘box’ : boxplot -
‘kde’ : Kernel Density Estimation plot - ‘density’ : same as ‘kde’ -
‘area’ : area plot - ‘pie’ : pie plot - ‘scatter’ : scatter plot -
‘hexbin’ : hexbin plot</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Ratio&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">,</span> <span class="s1">&#39;Unemployment&#39;</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>

<span class="n">market_share_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;Trader Joes&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Walmart&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">5</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;Publix&#39;</span><span class="p">,</span> <span class="o">.</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Market Share&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Company&#39;</span><span class="p">)</span>
<span class="n">market_share_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Market Share&#39;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;pie&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="../_images/sphx_glr_data_management_in_python_005.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_data_management_in_python_005.png" />
</li>
<li><img alt="../_images/sphx_glr_data_management_in_python_006.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_data_management_in_python_006.png" />
</li>
<li><img alt="../_images/sphx_glr_data_management_in_python_007.png" class="sphx-glr-multi-img" src="../_images/sphx_glr_data_management_in_python_007.png" />
</li>
</ul>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot object at 0x7f0d6a35e550&gt;
</pre></div>
</div>
<p>Check out the <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> package for some cool high level plotting
capabilities.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># convention for importing seaborn</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Company&#39;</span><span class="p">,</span> <span class="s1">&#39;Return&#39;</span><span class="p">,</span> <span class="s1">&#39;State Return Average&#39;</span><span class="p">]],</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Company&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_data_management_in_python_008.png" class="sphx-glr-single-img" src="../_images/sphx_glr_data_management_in_python_008.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid object at 0x7f0d6a358450&gt;
</pre></div>
</div>
</div>
</div>
<div class="section" id="regressions">
<h2>Regressions<a class="headerlink" href="#regressions" title="Permalink to this headline">¶</a></h2>
<p>Alright, we’ve got some cleaned up data. Now we can run regressions on
them with the <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> module. Here I will show the “formula”
approach to <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>, which is just one of the two main
interfaces. The <code class="docutils literal notranslate"><span class="pre">formula</span></code> approach will feel similar to specifying a
regression in <code class="docutils literal notranslate"><span class="pre">R</span></code> or <code class="docutils literal notranslate"><span class="pre">Stata</span></code>. However we can also directly pass
<code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> containing the y and x variables rather than specifying a
formula.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>

<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span> <span class="c1"># convention for importing statsmodels</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;Return ~ Unemployment&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/.local/share/virtualenvs/py-research-workflows-rjN0B_bW/lib/python3.7/site-packages/scipy/stats/stats.py:1535: UserWarning: kurtosistest only valid for n&gt;=20 ... continuing anyway, n=9
  &quot;anyway, n=%i&quot; % int(n))
</pre></div>
</div>
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>Return</td>      <th>  R-squared:         </th> <td>   0.000</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>  -0.143</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   0.000</td>
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 19 Feb 2020</td> <th>  Prob (F-statistic):</th>  <td>  1.00</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:50:52</td>     <th>  Log-Likelihood:    </th> <td>  17.751</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>     9</td>      <th>  AIC:               </th> <td>  -31.50</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>     7</td>      <th>  BIC:               </th> <td>  -31.11</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
        <td></td>          <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th>    <td>    0.0700</td> <td>    0.091</td> <td>    0.770</td> <td> 0.466</td> <td>   -0.145</td> <td>    0.285</td>
</tr>
<tr>
  <th>Unemployment</th> <td> 5.551e-16</td> <td>    1.350</td> <td> 4.11e-16</td> <td> 1.000</td> <td>   -3.191</td> <td>    3.191</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 1.292</td> <th>  Durbin-Watson:     </th> <td>   0.765</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.524</td> <th>  Jarque-Bera (JB):  </th> <td>   0.667</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.000</td> <th>  Prob(JB):          </th> <td>   0.716</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.666</td> <th>  Cond. No.          </th> <td>    107.</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
<br />
<br /><p>Looks like a regression summary should. We can also use fixed effects
and interaction terms. Here showing fixed effects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Ratio Size&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio_size&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># statsmodels formula doesn&#39;t like spaces in column names</span>
<span class="n">model2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;Return ~ Unemployment + C(ratio_size)&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>Return</td>      <th>  R-squared:         </th> <td>   0.941</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.922</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   48.00</td>
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 19 Feb 2020</td> <th>  Prob (F-statistic):</th> <td>0.000204</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:50:52</td>     <th>  Log-Likelihood:    </th> <td>  30.501</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>     9</td>      <th>  AIC:               </th> <td>  -55.00</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>     6</td>      <th>  BIC:               </th> <td>  -54.41</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
            <td></td>               <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th>             <td>    0.0696</td> <td>    0.006</td> <td>   12.163</td> <td> 0.000</td> <td>    0.056</td> <td>    0.084</td>
</tr>
<tr>
  <th>C(ratio_size)[T.High]</th> <td>    0.0401</td> <td>    0.008</td> <td>    4.919</td> <td> 0.003</td> <td>    0.020</td> <td>    0.060</td>
</tr>
<tr>
  <th>C(ratio_size)[T.Low]</th>  <td>   -0.0399</td> <td>    0.008</td> <td>   -4.892</td> <td> 0.003</td> <td>   -0.060</td> <td>   -0.020</td>
</tr>
<tr>
  <th>Unemployment</th>          <td>    0.0056</td> <td>    0.001</td> <td>    7.867</td> <td> 0.000</td> <td>    0.004</td> <td>    0.007</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.380</td> <th>  Durbin-Watson:     </th> <td>   2.333</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.304</td> <th>  Jarque-Bera (JB):  </th> <td>   0.844</td>
</tr>
<tr>
  <th>Skew:</th>          <td>-0.000</td> <th>  Prob(JB):          </th> <td>   0.656</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 1.500</td> <th>  Cond. No.          </th> <td>3.54e+17</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The smallest eigenvalue is 8.96e-35. This might indicate that there are<br/>strong multicollinearity problems or that the design matrix is singular.
<br />
<br /><p>Now interaction terms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># use * for interaction keeping individual variables, : for only interaction</span>
<span class="n">model3</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;Return ~ Unemployment*Ratio&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">result3</span> <span class="o">=</span> <span class="n">model3</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result3</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>Return</td>      <th>  R-squared:         </th> <td>   0.928</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.904</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   38.83</td>
</tr>
<tr>
  <th>Date:</th>             <td>Wed, 19 Feb 2020</td> <th>  Prob (F-statistic):</th> <td>0.000369</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:50:52</td>     <th>  Log-Likelihood:    </th> <td>  29.609</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>     9</td>      <th>  AIC:               </th> <td>  -53.22</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>     6</td>      <th>  BIC:               </th> <td>  -52.63</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>
</tr>
</table>
<table class="simpletable">
<tr>
           <td></td>             <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>
</tr>
<tr>
  <th>Intercept</th>          <td>    0.0020</td> <td>    0.017</td> <td>    0.121</td> <td> 0.907</td> <td>   -0.039</td> <td>    0.043</td>
</tr>
<tr>
  <th>Unemployment</th>       <td>   -0.0020</td> <td>    0.195</td> <td>   -0.010</td> <td> 0.992</td> <td>   -0.479</td> <td>    0.475</td>
</tr>
<tr>
  <th>Ratio</th>              <td>    0.0680</td> <td>    0.014</td> <td>    4.849</td> <td> 0.003</td> <td>    0.034</td> <td>    0.102</td>
</tr>
<tr>
  <th>Unemployment:Ratio</th> <td>    0.0020</td> <td>    0.195</td> <td>    0.010</td> <td> 0.992</td> <td>   -0.476</td> <td>    0.480</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 0.037</td> <th>  Durbin-Watson:     </th> <td>   2.212</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.982</td> <th>  Jarque-Bera (JB):  </th> <td>   0.148</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.057</td> <th>  Prob(JB):          </th> <td>   0.929</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.383</td> <th>  Cond. No.          </th> <td>1.77e+17</td>
</tr>
</table><br/><br/>Warnings:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br/>[2] The smallest eigenvalue is 6.15e-34. This might indicate that there are<br/>strong multicollinearity problems or that the design matrix is singular.
<br />
<br /><p>Want to throw together these models into one summary table?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.iolib.summary2</span> <span class="kn">import</span> <span class="n">summary_col</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">reg_list</span></a> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">result2</span><span class="p">,</span> <span class="n">result3</span><span class="p">]</span>
<span class="n">summ</span> <span class="o">=</span> <span class="n">summary_col</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">reg_list</span></a><span class="p">,</span>
    <span class="n">stars</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">info_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{0:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">nobs</span><span class="p">)),</span>
        <span class="s1">&#39;Adj-R2&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">rsquared_adj</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">summ</span>
</pre></div>
</div>
<table class="simpletable">
<tr>
            <td></td>            <th>Return I</th>  <th>Return II</th> <th>Return III</th>
</tr>
<tr>
  <th>C(ratio_size)[T.High]</th>     <td></td>      <td>0.0401***</td>      <td></td>
</tr>
<tr>
  <th></th>                          <td></td>      <td>(0.0082)</td>       <td></td>
</tr>
<tr>
  <th>C(ratio_size)[T.Low]</th>      <td></td>     <td>-0.0399***</td>      <td></td>
</tr>
<tr>
  <th></th>                          <td></td>      <td>(0.0082)</td>       <td></td>
</tr>
<tr>
  <th>Intercept</th>              <td>0.0700</td>   <td>0.0696***</td>   <td>0.0020</td>
</tr>
<tr>
  <th></th>                      <td>(0.0909)</td>  <td>(0.0057)</td>   <td>(0.0167)</td>
</tr>
<tr>
  <th>R-squared</th>              <td>-0.1429</td>   <td>0.9216</td>     <td>0.9044</td>
</tr>
<tr>
  <th></th>                       <td>0.0000</td>    <td>0.9412</td>     <td>0.9283</td>
</tr>
<tr>
  <th>Ratio</th>                     <td></td>          <td></td>       <td>0.0680***</td>
</tr>
<tr>
  <th></th>                          <td></td>          <td></td>       <td>(0.0140)</td>
</tr>
<tr>
  <th>Unemployment</th>           <td>0.0000</td>   <td>0.0056***</td>   <td>-0.0020</td>
</tr>
<tr>
  <th></th>                      <td>(1.3496)</td>  <td>(0.0007)</td>   <td>(0.1951)</td>
</tr>
<tr>
  <th>Unemployment:Ratio</th>        <td></td>          <td></td>        <td>0.0020</td>
</tr>
<tr>
  <th></th>                          <td></td>          <td></td>       <td>(0.1953)</td>
</tr>
<tr>
  <th>N</th>                         <td>9</td>         <td>9</td>          <td>9</td>
</tr>
<tr>
  <th>Adj-R2</th>                  <td>-0.14</td>     <td>0.92</td>       <td>0.90</td>
</tr>
</table>
<br />
<br /><p>On the backend, <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>’ <code class="docutils literal notranslate"><span class="pre">summary_col</span></code> uses a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
which we can access as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">summ</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Return I</th>
      <th>Return II</th>
      <th>Return III</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C(ratio_size)[T.High]</th>
      <td></td>
      <td>0.0401***</td>
      <td></td>
    </tr>
    <tr>
      <th></th>
      <td></td>
      <td>(0.0082)</td>
      <td></td>
    </tr>
    <tr>
      <th>C(ratio_size)[T.Low]</th>
      <td></td>
      <td>-0.0399***</td>
      <td></td>
    </tr>
    <tr>
      <th></th>
      <td></td>
      <td>(0.0082)</td>
      <td></td>
    </tr>
    <tr>
      <th>Intercept</th>
      <td>0.0700</td>
      <td>0.0696***</td>
      <td>0.0020</td>
    </tr>
    <tr>
      <th></th>
      <td>(0.0909)</td>
      <td>(0.0057)</td>
      <td>(0.0167)</td>
    </tr>
    <tr>
      <th>R-squared</th>
      <td>-0.1429</td>
      <td>0.9216</td>
      <td>0.9044</td>
    </tr>
    <tr>
      <th></th>
      <td>0.0000</td>
      <td>0.9412</td>
      <td>0.9283</td>
    </tr>
    <tr>
      <th>Ratio</th>
      <td></td>
      <td></td>
      <td>0.0680***</td>
    </tr>
    <tr>
      <th></th>
      <td></td>
      <td></td>
      <td>(0.0140)</td>
    </tr>
    <tr>
      <th>Unemployment</th>
      <td>0.0000</td>
      <td>0.0056***</td>
      <td>-0.0020</td>
    </tr>
    <tr>
      <th></th>
      <td>(1.3496)</td>
      <td>(0.0007)</td>
      <td>(0.1951)</td>
    </tr>
    <tr>
      <th>Unemployment:Ratio</th>
      <td></td>
      <td></td>
      <td>0.0020</td>
    </tr>
    <tr>
      <th></th>
      <td></td>
      <td></td>
      <td>(0.1953)</td>
    </tr>
    <tr>
      <th>N</th>
      <td>9</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>Adj-R2</th>
      <td>-0.14</td>
      <td>0.92</td>
      <td>0.90</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Therefore we can write functions to do any cleanup we want on the
summary, leveraging <code class="docutils literal notranslate"><span class="pre">pandas</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">replace_fixed_effects_cols</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    hackish way to do this just for example</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span> <span class="c1">#remove fixed effect dummy rows</span>
    <span class="n">out_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Ratio Size Fixed Effects&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;No&#39;</span><span class="p">,</span> <span class="s1">&#39;Yes&#39;</span><span class="p">,</span> <span class="s1">&#39;No&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out_df</span>

<span class="n">clean_summ</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">replace_fixed_effects_cols</span></a><span class="p">(</span><span class="n">summ</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">clean_summ</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/.local/share/virtualenvs/py-research-workflows-rjN0B_bW/lib/python3.7/site-packages/pandas/core/indexing.py:670: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self._setitem_with_indexer(indexer, value)
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Return I</th>
      <th>Return II</th>
      <th>Return III</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.0700</td>
      <td>0.0696***</td>
      <td>0.0020</td>
    </tr>
    <tr>
      <th></th>
      <td>(0.0909)</td>
      <td>(0.0057)</td>
      <td>(0.0167)</td>
    </tr>
    <tr>
      <th>R-squared</th>
      <td>-0.1429</td>
      <td>0.9216</td>
      <td>0.9044</td>
    </tr>
    <tr>
      <th></th>
      <td>0.0000</td>
      <td>0.9412</td>
      <td>0.9283</td>
    </tr>
    <tr>
      <th>Ratio</th>
      <td></td>
      <td></td>
      <td>0.0680***</td>
    </tr>
    <tr>
      <th></th>
      <td></td>
      <td></td>
      <td>(0.0140)</td>
    </tr>
    <tr>
      <th>Unemployment</th>
      <td>0.0000</td>
      <td>0.0056***</td>
      <td>-0.0020</td>
    </tr>
    <tr>
      <th></th>
      <td>(1.3496)</td>
      <td>(0.0007)</td>
      <td>(0.1951)</td>
    </tr>
    <tr>
      <th>Unemployment:Ratio</th>
      <td></td>
      <td></td>
      <td>0.0020</td>
    </tr>
    <tr>
      <th></th>
      <td></td>
      <td></td>
      <td>(0.1953)</td>
    </tr>
    <tr>
      <th>N</th>
      <td>9</td>
      <td>9</td>
      <td>9</td>
    </tr>
    <tr>
      <th>Adj-R2</th>
      <td>-0.14</td>
      <td>0.92</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>Ratio Size Fixed Effects</th>
      <td>No</td>
      <td>Yes</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /><p>Pretty cool, right? Since it’s a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, we can even output it to
LaTeX:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clean_summ</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">to_latex</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;\\begin{tabular}{llll}\n\\toprule\n{} &amp;  Return I &amp;  Return II &amp; Return III \\\\\n\\midrule\nIntercept                &amp;    0.0700 &amp;  0.0696*** &amp;     0.0020 \\\\\n                         &amp;  (0.0909) &amp;   (0.0057) &amp;   (0.0167) \\\\\nR-squared                &amp;   -0.1429 &amp;     0.9216 &amp;     0.9044 \\\\\n                         &amp;    0.0000 &amp;     0.9412 &amp;     0.9283 \\\\\nRatio                    &amp;           &amp;            &amp;  0.0680*** \\\\\n                         &amp;           &amp;            &amp;   (0.0140) \\\\\nUnemployment             &amp;    0.0000 &amp;  0.0056*** &amp;    -0.0020 \\\\\n                         &amp;  (1.3496) &amp;   (0.0007) &amp;   (0.1951) \\\\\nUnemployment:Ratio       &amp;           &amp;            &amp;     0.0020 \\\\\n                         &amp;           &amp;            &amp;   (0.1953) \\\\\nN                        &amp;         9 &amp;          9 &amp;          9 \\\\\nAdj-R2                   &amp;     -0.14 &amp;       0.92 &amp;       0.90 \\\\\nRatio Size Fixed Effects &amp;        No &amp;        Yes &amp;         No \\\\\n\\bottomrule\n\\end{tabular}\n&#39;
</pre></div>
</div>
<p>Looks messy here, but you can output it to a file. However it’s only
outputting the direct LaTeX for the table so we can add a wrapper so it
will compile as document:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_latex_text_wrapper</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">begin_text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    \documentclass[12pt]</span><span class="si">{article}</span><span class="s2"></span>
<span class="s2">\usepackage</span><span class="si">{booktabs}</span><span class="s2"></span>
<span class="s2">\begin</span><span class="si">{document}</span><span class="s2"></span>

<span class="s2">\begin</span><span class="si">{table}</span><span class="s2"></span>

<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">end_text</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">    \end</span><span class="si">{table}</span><span class="s2"></span>
<span class="s2">\end</span><span class="si">{document}</span><span class="s2"></span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">begin_text</span> <span class="o">+</span> <span class="n">text</span> <span class="o">+</span> <span class="n">end_text</span>

<span class="k">def</span> <span class="nf">to_latex</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="s1">&#39;temp.tex&#39;</span><span class="p">):</span>
    <span class="n">latex</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">to_latex</span></a><span class="p">()</span>
    <span class="n">full_latex</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">_latex_text_wrapper</span></a><span class="p">(</span><span class="n">latex</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">full_latex</span><span class="p">)</span>

<a href="https://docs.python.org/3/library/functions.html#object" title="View documentation for builtins.object"><span class="n">to_latex</span></a><span class="p">(</span><span class="n">clean_summ</span><span class="p">)</span> <span class="c1"># created temp.tex in this folder. Go look and try to compile</span>
</pre></div>
</div>
</div>
<div class="section" id="input-and-output">
<h2>Input and Output<a class="headerlink" href="#input-and-output" title="Permalink to this headline">¶</a></h2>
<p>Let’s output our existing <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> to some different formats and
then show it can be loaded in through those formats as well.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># We are not using the index, so don&#39;t write it to file</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;temp.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;temp.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_stata</span><span class="p">(</span><span class="s1">&#39;temp.dta&#39;</span><span class="p">,</span> <span class="n">write_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># NOTE: it is possible to read from SAS7BDAT but not write to it</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;temp.csv&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;temp.xlsx&#39;</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">read_stata</span><span class="p">(</span><span class="s1">&#39;temp.dta&#39;</span><span class="p">)</span>

<span class="c1"># pd.read_sas(&#39;temp.sas7bdat&#39;) #doesn&#39;t exist because we couldn&#39;t write to it. But if you already have sas data this will work</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/.local/share/virtualenvs/py-research-workflows-rjN0B_bW/lib/python3.7/site-packages/pandas/io/stata.py:2252: InvalidColumnName:
Not all pandas column names were valid Stata variable names.
The following replacements have been made:

    b&#39;State Return Average&#39;   -&gt;   State_Return_Average
    b&#39;Lag Return&#39;   -&gt;   Lag_Return

If this is not what you expect, please make sure you have Stata-compliant
column names in your DataFrame (strings only, max 32 characters, only
alphanumerics and underscores, no Stata reserved words)

  warnings.warn(ws, InvalidColumnName)
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Company</th>
      <th>State</th>
      <th>Date</th>
      <th>Return</th>
      <th>State_Return_Average</th>
      <th>Ratio</th>
      <th>ratio_size</th>
      <th>Unemployment</th>
      <th>Lag_Return</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Publix</td>
      <td>FL</td>
      <td>2000-01-02</td>
      <td>0.10</td>
      <td>0.06</td>
      <td>1.666667</td>
      <td>High</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Publix</td>
      <td>FL</td>
      <td>2000-01-03</td>
      <td>0.11</td>
      <td>0.07</td>
      <td>1.571429</td>
      <td>High</td>
      <td>0.06</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Publix</td>
      <td>FL</td>
      <td>2000-01-04</td>
      <td>0.12</td>
      <td>0.08</td>
      <td>1.500000</td>
      <td>High</td>
      <td>0.06</td>
      <td>0.11</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>2000-01-02</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>2000-01-03</td>
      <td>0.07</td>
      <td>0.07</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Trader Joes</td>
      <td>GA</td>
      <td>2000-01-04</td>
      <td>0.08</td>
      <td>0.08</td>
      <td>1.000000</td>
      <td>Even</td>
      <td>0.08</td>
      <td>0.07</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>2000-01-02</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.333333</td>
      <td>Low</td>
      <td>0.06</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>2000-01-03</td>
      <td>0.03</td>
      <td>0.07</td>
      <td>0.428571</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Walmart</td>
      <td>FL</td>
      <td>2000-01-04</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>0.500000</td>
      <td>Low</td>
      <td>0.06</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
</div>
<br />
<br /></div>
<div class="section" id="some-clean-up">
<h2>Some Clean Up<a class="headerlink" href="#some-clean-up" title="Permalink to this headline">¶</a></h2>
<p>This section is not important, just cleaning up the temporary files we
just generated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">clean_files</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;temp.csv&#39;</span><span class="p">,</span>
    <span class="s1">&#39;temp.xlsx&#39;</span><span class="p">,</span>
    <span class="s1">&#39;temp.dta&#39;</span><span class="p">,</span>
    <span class="s1">&#39;temp.tex&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">file</span></a> <span class="ow">in</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="View documentation for builtins.list"><span class="n">clean_files</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/os.html#os.remove" title="View documentation for os.remove"><span class="n">os</span><span class="o">.</span><span class="n">remove</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="View documentation for builtins.str"><span class="n">file</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.657 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-data-management-in-python-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/nickderobertis/py-research-workflows/gh-pages?urlpath=lab/tree/notebooks/auto_examples/data_management_in_python.ipynb"><img alt="https://mybinder.org/badge_logo.svg" src="https://mybinder.org/badge_logo.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/1d55343a6d8cb5c434cdd69190de1d29/data_management_in_python.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">data_management_in_python.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ef6ae7b00ffb07030a871da6e0925180/data_management_in_python.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">data_management_in_python.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="additional_research_tools.html" class="btn btn-neutral float-right" title="Additional Research Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Examples and Workflows" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Nick DeRobertis

    </p>
  </div>
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-158687321-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>